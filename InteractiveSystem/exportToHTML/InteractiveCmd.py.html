<html>
<head>
<title>InteractiveCmd.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: rgb(0,0,0); font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { }
.s2 { color: rgb(128,128,128); font-style: italic; }
.s3 { color: rgb(0,0,255); }
.s4 { color: rgb(0,128,128); font-weight: bold; }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
InteractiveCmd.py</FONT>
</center></TD></TR></TABLE>
<pre>

<span class="s0">import </span><span class="s1">threading 
</span><span class="s0">import </span><span class="s1">queue 
 
 
</span><span class="s0">class </span><span class="s1">InteractiveCmd(threading.Thread): 
 
    </span><span class="s0">def </span><span class="s1">__init__(self): 
 
        </span><span class="s2"># command queue</span><span class="s1"> 
        self.cmd_q = queue.Queue() 
 
        </span><span class="s2"># start thread</span><span class="s1"> 
        threading.Thread.__init__(self) 
        self.daemon = </span><span class="s0">False</span><span class="s1"> 
        self.start() 
 
    </span><span class="s0">def </span><span class="s1">run(self): 
 
        </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">4</span><span class="s1">): 
            cmd_obj = command_object(i) 
            cmd_obj.add_param_change(</span><span class="s4">&quot;param&quot;</span><span class="s1">+str(i), i*i) 
            self.get_command(command_object) 
 
       </span><span class="s2"># self.get_command()</span><span class="s1"> 
 
    </span><span class="s0">def </span><span class="s1">get_command(self, cmd=</span><span class="s0">None</span><span class="s1">): 
 
        </span><span class="s0">if </span><span class="s1">isinstance(cmd, command_object): 
            self.cmd_q.put(cmd) 
 
        </span><span class="s2"># prompt users for inputs</span><span class="s1"> 
        </span><span class="s0">elif </span><span class="s1">cmd </span><span class="s0">is None</span><span class="s1">: 
            cmd = input(</span><span class="s4">&quot;Enter: [Teensy_ID] [param_type]:[param_value] (separated by space).</span><span class="s0">\n</span><span class="s4">&quot; </span><span class="s1">+ 
                        </span><span class="s4">&quot;To apply changes, enter '&gt;&gt;apply'.</span><span class="s0">\n</span><span class="s4">&quot;</span><span class="s1">) 
 
            param_cmd_list = cmd.split(</span><span class="s4">&quot; &quot;</span><span class="s1">) 
 
            </span><span class="s0">try</span><span class="s1">: 
                dev_id = int(param_cmd_list[</span><span class="s3">0</span><span class="s1">]) 
            </span><span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e: 
                print(e) 
                </span><span class="s0">return </span><span class="s1">-</span><span class="s3">1</span><span class="s1"> 
 
            cmd_obj = command_object(dev_id) 
 
            </span><span class="s0">for </span><span class="s1">param_cmd </span><span class="s0">in </span><span class="s1">param_cmd_list[</span><span class="s3">1</span><span class="s1">:]: 
                param = param_cmd.split(</span><span class="s4">&quot;:&quot;</span><span class="s1">) 
                cmd_obj.add_param_change(param[</span><span class="s3">0</span><span class="s1">], param[</span><span class="s3">1</span><span class="s1">]) 
 
            self.cmd_q.put(cmd_obj) 
 
 
    </span><span class="s0">def </span><span class="s1">send_command(self): 
        </span><span class="s0">pass</span><span class="s1"> 
 
 
</span><span class="s0">class </span><span class="s1">command_object(): 
 
    </span><span class="s0">def </span><span class="s1">__init__(self, teensy_id): 
        </span><span class="s0">if not </span><span class="s1">isinstance(teensy_id, int): 
            </span><span class="s0">raise </span><span class="s1">TypeError(</span><span class="s4">&quot;Teensy ID must be an integer!&quot;</span><span class="s1">) 
 
        self.teensy_id = teensy_id 
        self.param_change = dict() 
 
    </span><span class="s0">def </span><span class="s1">add_param_change(self, type, value): 
        </span><span class="s0">if </span><span class="s1">isinstance(type, str): 
            self.param_change[type] = value 
        </span><span class="s0">else</span><span class="s1">: 
            </span><span class="s0">raise </span><span class="s1">TypeError(</span><span class="s4">&quot;'State type' must be a string!&quot;</span><span class="s1">) 
 
    </span><span class="s0">def </span><span class="s1">print(self): 
        print(self.teensy_id, end=</span><span class="s4">': '</span><span class="s1">) 
        </span><span class="s0">for </span><span class="s1">type, value </span><span class="s0">in </span><span class="s1">self.param_change.items(): 
            print(</span><span class="s4">'('</span><span class="s1">, type, </span><span class="s4">'-'</span><span class="s1">, value, </span><span class="s4">') '</span><span class="s1">, end=</span><span class="s4">&quot;&quot;</span><span class="s1">) 
        print(</span><span class="s4">''</span><span class="s1">) 
 
 
 
</span><span class="s0">if </span><span class="s1">__name__ == </span><span class="s4">'__main__'</span><span class="s1">: 
 
    t = InteractiveCmd() 
 
    t.join() 
 
    </span><span class="s0">while not </span><span class="s1">t.cmd_q.empty(): 
        t.cmd_q.get().print() 
 
 
</span></pre>
</body>
</html>